{"version":3,"sources":["@wordpress/block-editor/src/hooks/color.js"],"names":["classnames","isObject","addFilter","getBlockSupport","__","useRef","useEffect","useMemo","Platform","createHigherOrderComponent","getColorClassName","getColorObjectByColorValue","getColorObjectByAttributeValues","__experimentalGetGradientClass","getGradientValueBySlug","getGradientSlugByValue","cleanEmptyObject","transformStyles","immutableSet","shouldSkipSerialization","ColorPanel","useSetting","COLOR_SUPPORT_KEY","hasColorSupport","blockType","colorSupport","link","gradient","background","text","hasLinkColorSupport","OS","hasGradientSupport","gradients","hasBackgroundColorSupport","hasTextColorSupport","hasColor","name","props","attributes","backgroundColor","style","color","elements","clearColorFromStyles","path","undefined","resetTextColor","setAttributes","textColor","resetAllTextFilter","resetLinkColor","resetAllLinkFilter","clearBackgroundAndGradient","resetBackgroundAndGradient","addAttributes","settings","Object","assign","type","addSaveProps","hasGradient","shouldSerialize","feature","textClass","gradientClass","backgroundClass","serializeHasBackground","hasBackground","newClassName","className","addEditProps","existingGetEditWrapperProps","getEditWrapperProps","getLinkColorFromAttributeValue","colors","value","attributeParsed","exec","ColorEdit","blockName","userPalette","themePalette","defaultPalette","allSolids","userGradientPalette","themeGradientPalette","defaultGradientPalette","allGradients","areCustomSolidsEnabled","areCustomGradientsEnabled","isBackgroundEnabled","isLinkEnabled","isTextEnabled","solidsEnabled","length","gradientsEnabled","localAttributes","current","hasLinkColor","hasTextColor","hasBackgroundColor","hasGradientColor","gradientValue","onChangeColor","colorObject","attributeName","newStyle","slug","newNamedColor","newAttributes","onChangeGradient","onChangeLinkColor","newLinkColorValue","enableContrastChecking","defaultColorControls","clientId","label","onColorChange","colorValue","isShownByDefault","hasValue","onDeselect","resetAllFilter","onGradientChange","clearable","withColorPaletteStyles","BlockListBlock","extraStyles","wrapperProps","MIGRATION_PATHS","linkColor","addTransforms","result","source","index","results","destinationBlockType","activeSupports"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport classnames from 'classnames';\nimport { isObject } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport { addFilter } from '@wordpress/hooks';\nimport { getBlockSupport } from '@wordpress/blocks';\nimport { __ } from '@wordpress/i18n';\nimport { useRef, useEffect, useMemo, Platform } from '@wordpress/element';\nimport { createHigherOrderComponent } from '@wordpress/compose';\n\n/**\n * Internal dependencies\n */\nimport {\n\tgetColorClassName,\n\tgetColorObjectByColorValue,\n\tgetColorObjectByAttributeValues,\n} from '../components/colors';\nimport {\n\t__experimentalGetGradientClass,\n\tgetGradientValueBySlug,\n\tgetGradientSlugByValue,\n} from '../components/gradients';\nimport {\n\tcleanEmptyObject,\n\ttransformStyles,\n\timmutableSet,\n\tshouldSkipSerialization,\n} from './utils';\nimport ColorPanel from './color-panel';\nimport useSetting from '../components/use-setting';\n\nexport const COLOR_SUPPORT_KEY = 'color';\n\nconst hasColorSupport = ( blockType ) => {\n\tconst colorSupport = getBlockSupport( blockType, COLOR_SUPPORT_KEY );\n\treturn (\n\t\tcolorSupport &&\n\t\t( colorSupport.link === true ||\n\t\t\tcolorSupport.gradient === true ||\n\t\t\tcolorSupport.background !== false ||\n\t\t\tcolorSupport.text !== false )\n\t);\n};\n\nconst hasLinkColorSupport = ( blockType ) => {\n\tif ( Platform.OS !== 'web' ) {\n\t\treturn false;\n\t}\n\n\tconst colorSupport = getBlockSupport( blockType, COLOR_SUPPORT_KEY );\n\n\treturn isObject( colorSupport ) && !! colorSupport.link;\n};\n\nconst hasGradientSupport = ( blockType ) => {\n\tconst colorSupport = getBlockSupport( blockType, COLOR_SUPPORT_KEY );\n\n\treturn isObject( colorSupport ) && !! colorSupport.gradients;\n};\n\nconst hasBackgroundColorSupport = ( blockType ) => {\n\tconst colorSupport = getBlockSupport( blockType, COLOR_SUPPORT_KEY );\n\n\treturn colorSupport && colorSupport.background !== false;\n};\n\nconst hasTextColorSupport = ( blockType ) => {\n\tconst colorSupport = getBlockSupport( blockType, COLOR_SUPPORT_KEY );\n\n\treturn colorSupport && colorSupport.text !== false;\n};\n\n/**\n * Checks whether a color has been set either with a named preset color in\n * a top level block attribute or as a custom value within the style attribute\n * object.\n *\n * @param {string} name Name of the color to check.\n * @return {boolean} Whether or not a color has a value.\n */\nconst hasColor = ( name ) => ( props ) => {\n\tif ( name === 'background' ) {\n\t\treturn (\n\t\t\t!! props.attributes.backgroundColor ||\n\t\t\t!! props.attributes.style?.color?.background ||\n\t\t\t!! props.attributes.gradient ||\n\t\t\t!! props.attributes.style?.color?.gradient\n\t\t);\n\t}\n\n\tif ( name === 'link' ) {\n\t\treturn !! props.attributes.style?.elements?.link?.color?.text;\n\t}\n\n\treturn (\n\t\t!! props.attributes[ `${ name }Color` ] ||\n\t\t!! props.attributes.style?.color?.[ name ]\n\t);\n};\n\n/**\n * Clears a single color property from a style object.\n *\n * @param {Array}  path  Path to color property to clear within styles object.\n * @param {Object} style Block attributes style object.\n * @return {Object} Styles with the color property omitted.\n */\nconst clearColorFromStyles = ( path, style ) =>\n\tcleanEmptyObject( immutableSet( style, path, undefined ) );\n\n/**\n * Resets the block attributes for text color.\n *\n * @param {Object}   props               Current block props.\n * @param {Object}   props.attributes    Block attributes.\n * @param {Function} props.setAttributes Block's setAttributes prop used to apply reset.\n */\nconst resetTextColor = ( { attributes, setAttributes } ) => {\n\tsetAttributes( {\n\t\ttextColor: undefined,\n\t\tstyle: clearColorFromStyles( [ 'color', 'text' ], attributes.style ),\n\t} );\n};\n\n/**\n * Clears text color related properties from supplied attributes.\n *\n * @param {Object} attributes Block attributes.\n * @return {Object} Update block attributes with text color properties omitted.\n */\nconst resetAllTextFilter = ( attributes ) => ( {\n\ttextColor: undefined,\n\tstyle: clearColorFromStyles( [ 'color', 'text' ], attributes.style ),\n} );\n\n/**\n * Resets the block attributes for link color.\n *\n * @param {Object}   props               Current block props.\n * @param {Object}   props.attributes    Block attributes.\n * @param {Function} props.setAttributes Block's setAttributes prop used to apply reset.\n */\nconst resetLinkColor = ( { attributes, setAttributes } ) => {\n\tconst path = [ 'elements', 'link', 'color', 'text' ];\n\tsetAttributes( { style: clearColorFromStyles( path, attributes.style ) } );\n};\n\n/**\n * Clears link color related properties from supplied attributes.\n *\n * @param {Object} attributes Block attributes.\n * @return {Object} Update block attributes with link color properties omitted.\n */\nconst resetAllLinkFilter = ( attributes ) => ( {\n\tstyle: clearColorFromStyles(\n\t\t[ 'elements', 'link', 'color', 'text' ],\n\t\tattributes.style\n\t),\n} );\n\n/**\n * Clears all background color related properties including gradients from\n * supplied block attributes.\n *\n * @param {Object} attributes Block attributes.\n * @return {Object} Block attributes with background and gradient omitted.\n */\nconst clearBackgroundAndGradient = ( attributes ) => ( {\n\tbackgroundColor: undefined,\n\tgradient: undefined,\n\tstyle: {\n\t\t...attributes.style,\n\t\tcolor: {\n\t\t\t...attributes.style?.color,\n\t\t\tbackground: undefined,\n\t\t\tgradient: undefined,\n\t\t},\n\t},\n} );\n\n/**\n * Resets the block attributes for both background color and gradient.\n *\n * @param {Object}   props               Current block props.\n * @param {Object}   props.attributes    Block attributes.\n * @param {Function} props.setAttributes Block's setAttributes prop used to apply reset.\n */\nconst resetBackgroundAndGradient = ( { attributes, setAttributes } ) => {\n\tsetAttributes( clearBackgroundAndGradient( attributes ) );\n};\n\n/**\n * Filters registered block settings, extending attributes to include\n * `backgroundColor` and `textColor` attribute.\n *\n * @param {Object} settings Original block settings.\n *\n * @return {Object} Filtered block settings.\n */\nfunction addAttributes( settings ) {\n\tif ( ! hasColorSupport( settings ) ) {\n\t\treturn settings;\n\t}\n\n\t// Allow blocks to specify their own attribute definition with default values if needed.\n\tif ( ! settings.attributes.backgroundColor ) {\n\t\tObject.assign( settings.attributes, {\n\t\t\tbackgroundColor: {\n\t\t\t\ttype: 'string',\n\t\t\t},\n\t\t} );\n\t}\n\tif ( ! settings.attributes.textColor ) {\n\t\tObject.assign( settings.attributes, {\n\t\t\ttextColor: {\n\t\t\t\ttype: 'string',\n\t\t\t},\n\t\t} );\n\t}\n\n\tif ( hasGradientSupport( settings ) && ! settings.attributes.gradient ) {\n\t\tObject.assign( settings.attributes, {\n\t\t\tgradient: {\n\t\t\t\ttype: 'string',\n\t\t\t},\n\t\t} );\n\t}\n\n\treturn settings;\n}\n\n/**\n * Override props assigned to save component to inject colors classnames.\n *\n * @param {Object} props      Additional props applied to save element.\n * @param {Object} blockType  Block type.\n * @param {Object} attributes Block attributes.\n *\n * @return {Object} Filtered props applied to save element.\n */\nexport function addSaveProps( props, blockType, attributes ) {\n\tif (\n\t\t! hasColorSupport( blockType ) ||\n\t\tshouldSkipSerialization( blockType, COLOR_SUPPORT_KEY )\n\t) {\n\t\treturn props;\n\t}\n\n\tconst hasGradient = hasGradientSupport( blockType );\n\n\t// I'd have preferred to avoid the \"style\" attribute usage here\n\tconst { backgroundColor, textColor, gradient, style } = attributes;\n\n\tconst shouldSerialize = ( feature ) =>\n\t\t! shouldSkipSerialization( blockType, COLOR_SUPPORT_KEY, feature );\n\n\t// Primary color classes must come before the `has-text-color`,\n\t// `has-background` and `has-link-color` classes to maintain backwards\n\t// compatibility and avoid block invalidations.\n\tconst textClass = shouldSerialize( 'text' )\n\t\t? getColorClassName( 'color', textColor )\n\t\t: undefined;\n\n\tconst gradientClass = shouldSerialize( 'gradients' )\n\t\t? __experimentalGetGradientClass( gradient )\n\t\t: undefined;\n\n\tconst backgroundClass = shouldSerialize( 'background' )\n\t\t? getColorClassName( 'background-color', backgroundColor )\n\t\t: undefined;\n\n\tconst serializeHasBackground =\n\t\tshouldSerialize( 'background' ) || shouldSerialize( 'gradients' );\n\tconst hasBackground =\n\t\tbackgroundColor ||\n\t\tstyle?.color?.background ||\n\t\t( hasGradient && ( gradient || style?.color?.gradient ) );\n\n\tconst newClassName = classnames(\n\t\tprops.className,\n\t\ttextClass,\n\t\tgradientClass,\n\t\t{\n\t\t\t// Don't apply the background class if there's a custom gradient.\n\t\t\t[ backgroundClass ]:\n\t\t\t\t( ! hasGradient || ! style?.color?.gradient ) &&\n\t\t\t\t!! backgroundClass,\n\t\t\t'has-text-color':\n\t\t\t\tshouldSerialize( 'text' ) &&\n\t\t\t\t( textColor || style?.color?.text ),\n\t\t\t'has-background': serializeHasBackground && hasBackground,\n\t\t\t'has-link-color':\n\t\t\t\tshouldSerialize( 'link' ) && style?.elements?.link?.color,\n\t\t}\n\t);\n\tprops.className = newClassName ? newClassName : undefined;\n\n\treturn props;\n}\n\n/**\n * Filters registered block settings to extend the block edit wrapper\n * to apply the desired styles and classnames properly.\n *\n * @param {Object} settings Original block settings.\n *\n * @return {Object} Filtered block settings.\n */\nexport function addEditProps( settings ) {\n\tif (\n\t\t! hasColorSupport( settings ) ||\n\t\tshouldSkipSerialization( settings, COLOR_SUPPORT_KEY )\n\t) {\n\t\treturn settings;\n\t}\n\tconst existingGetEditWrapperProps = settings.getEditWrapperProps;\n\tsettings.getEditWrapperProps = ( attributes ) => {\n\t\tlet props = {};\n\t\tif ( existingGetEditWrapperProps ) {\n\t\t\tprops = existingGetEditWrapperProps( attributes );\n\t\t}\n\t\treturn addSaveProps( props, settings, attributes );\n\t};\n\n\treturn settings;\n}\n\nconst getLinkColorFromAttributeValue = ( colors, value ) => {\n\tconst attributeParsed = /var:preset\\|color\\|(.+)/.exec( value );\n\tif ( attributeParsed && attributeParsed[ 1 ] ) {\n\t\treturn getColorObjectByAttributeValues( colors, attributeParsed[ 1 ] )\n\t\t\t.color;\n\t}\n\treturn value;\n};\n\n/**\n * Inspector control panel containing the color related configuration\n *\n * @param {Object} props\n *\n * @return {WPElement} Color edit element.\n */\nexport function ColorEdit( props ) {\n\tconst { name: blockName, attributes } = props;\n\t// Some color settings have a special handling for deprecated flags in `useSetting`,\n\t// so we can't unwrap them by doing const { ... } = useSetting('color')\n\t// until https://github.com/WordPress/gutenberg/issues/37094 is fixed.\n\tconst userPalette = useSetting( 'color.palette.custom' );\n\tconst themePalette = useSetting( 'color.palette.theme' );\n\tconst defaultPalette = useSetting( 'color.palette.default' );\n\tconst allSolids = useMemo(\n\t\t() => [\n\t\t\t...( userPalette || [] ),\n\t\t\t...( themePalette || [] ),\n\t\t\t...( defaultPalette || [] ),\n\t\t],\n\t\t[ userPalette, themePalette, defaultPalette ]\n\t);\n\tconst userGradientPalette = useSetting( 'color.gradients.custom' );\n\tconst themeGradientPalette = useSetting( 'color.gradients.theme' );\n\tconst defaultGradientPalette = useSetting( 'color.gradients.default' );\n\tconst allGradients = useMemo(\n\t\t() => [\n\t\t\t...( userGradientPalette || [] ),\n\t\t\t...( themeGradientPalette || [] ),\n\t\t\t...( defaultGradientPalette || [] ),\n\t\t],\n\t\t[ userGradientPalette, themeGradientPalette, defaultGradientPalette ]\n\t);\n\tconst areCustomSolidsEnabled = useSetting( 'color.custom' );\n\tconst areCustomGradientsEnabled = useSetting( 'color.customGradient' );\n\tconst isBackgroundEnabled = useSetting( 'color.background' );\n\tconst isLinkEnabled = useSetting( 'color.link' );\n\tconst isTextEnabled = useSetting( 'color.text' );\n\n\tconst solidsEnabled =\n\t\tareCustomSolidsEnabled || ! themePalette || themePalette?.length > 0;\n\n\tconst gradientsEnabled =\n\t\tareCustomGradientsEnabled ||\n\t\t! themeGradientPalette ||\n\t\tthemeGradientPalette?.length > 0;\n\n\t// Shouldn't be needed but right now the ColorGradientsPanel\n\t// can trigger both onChangeColor and onChangeBackground\n\t// synchronously causing our two callbacks to override changes\n\t// from each other.\n\tconst localAttributes = useRef( attributes );\n\tuseEffect( () => {\n\t\tlocalAttributes.current = attributes;\n\t}, [ attributes ] );\n\n\tif ( ! hasColorSupport( blockName ) ) {\n\t\treturn null;\n\t}\n\n\tconst hasLinkColor =\n\t\thasLinkColorSupport( blockName ) && isLinkEnabled && solidsEnabled;\n\tconst hasTextColor =\n\t\thasTextColorSupport( blockName ) && isTextEnabled && solidsEnabled;\n\tconst hasBackgroundColor =\n\t\thasBackgroundColorSupport( blockName ) &&\n\t\tisBackgroundEnabled &&\n\t\tsolidsEnabled;\n\tconst hasGradientColor =\n\t\thasGradientSupport( blockName ) && gradientsEnabled;\n\n\tif (\n\t\t! hasLinkColor &&\n\t\t! hasTextColor &&\n\t\t! hasBackgroundColor &&\n\t\t! hasGradientColor\n\t) {\n\t\treturn null;\n\t}\n\n\tconst { style, textColor, backgroundColor, gradient } = attributes;\n\tlet gradientValue;\n\tif ( hasGradientColor && gradient ) {\n\t\tgradientValue = getGradientValueBySlug( allGradients, gradient );\n\t} else if ( hasGradientColor ) {\n\t\tgradientValue = style?.color?.gradient;\n\t}\n\n\tconst onChangeColor = ( name ) => ( value ) => {\n\t\tconst colorObject = getColorObjectByColorValue( allSolids, value );\n\t\tconst attributeName = name + 'Color';\n\t\tconst newStyle = {\n\t\t\t...localAttributes.current.style,\n\t\t\tcolor: {\n\t\t\t\t...localAttributes.current?.style?.color,\n\t\t\t\t[ name ]: colorObject?.slug ? undefined : value,\n\t\t\t},\n\t\t};\n\n\t\tconst newNamedColor = colorObject?.slug ? colorObject.slug : undefined;\n\t\tconst newAttributes = {\n\t\t\tstyle: cleanEmptyObject( newStyle ),\n\t\t\t[ attributeName ]: newNamedColor,\n\t\t};\n\n\t\tprops.setAttributes( newAttributes );\n\t\tlocalAttributes.current = {\n\t\t\t...localAttributes.current,\n\t\t\t...newAttributes,\n\t\t};\n\t};\n\n\tconst onChangeGradient = ( value ) => {\n\t\tconst slug = getGradientSlugByValue( allGradients, value );\n\t\tlet newAttributes;\n\t\tif ( slug ) {\n\t\t\tconst newStyle = {\n\t\t\t\t...localAttributes.current?.style,\n\t\t\t\tcolor: {\n\t\t\t\t\t...localAttributes.current?.style?.color,\n\t\t\t\t\tgradient: undefined,\n\t\t\t\t},\n\t\t\t};\n\t\t\tnewAttributes = {\n\t\t\t\tstyle: cleanEmptyObject( newStyle ),\n\t\t\t\tgradient: slug,\n\t\t\t};\n\t\t} else {\n\t\t\tconst newStyle = {\n\t\t\t\t...localAttributes.current?.style,\n\t\t\t\tcolor: {\n\t\t\t\t\t...localAttributes.current?.style?.color,\n\t\t\t\t\tgradient: value,\n\t\t\t\t},\n\t\t\t};\n\t\t\tnewAttributes = {\n\t\t\t\tstyle: cleanEmptyObject( newStyle ),\n\t\t\t\tgradient: undefined,\n\t\t\t};\n\t\t}\n\t\tprops.setAttributes( newAttributes );\n\t\tlocalAttributes.current = {\n\t\t\t...localAttributes.current,\n\t\t\t...newAttributes,\n\t\t};\n\t};\n\n\tconst onChangeLinkColor = ( value ) => {\n\t\tconst colorObject = getColorObjectByColorValue( allSolids, value );\n\t\tconst newLinkColorValue = colorObject?.slug\n\t\t\t? `var:preset|color|${ colorObject.slug }`\n\t\t\t: value;\n\n\t\tconst newStyle = cleanEmptyObject(\n\t\t\timmutableSet(\n\t\t\t\tstyle,\n\t\t\t\t[ 'elements', 'link', 'color', 'text' ],\n\t\t\t\tnewLinkColorValue\n\t\t\t)\n\t\t);\n\t\tprops.setAttributes( { style: newStyle } );\n\t};\n\n\tconst enableContrastChecking =\n\t\tPlatform.OS === 'web' && ! gradient && ! style?.color?.gradient;\n\n\tconst defaultColorControls = getBlockSupport( props.name, [\n\t\tCOLOR_SUPPORT_KEY,\n\t\t'__experimentalDefaultControls',\n\t] );\n\n\treturn (\n\t\t<ColorPanel\n\t\t\tenableContrastChecking={ enableContrastChecking }\n\t\t\tclientId={ props.clientId }\n\t\t\tenableAlpha={ true }\n\t\t\tsettings={ [\n\t\t\t\t...( hasTextColor\n\t\t\t\t\t? [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlabel: __( 'Text' ),\n\t\t\t\t\t\t\t\tonColorChange: onChangeColor( 'text' ),\n\t\t\t\t\t\t\t\tcolorValue: getColorObjectByAttributeValues(\n\t\t\t\t\t\t\t\t\tallSolids,\n\t\t\t\t\t\t\t\t\ttextColor,\n\t\t\t\t\t\t\t\t\tstyle?.color?.text\n\t\t\t\t\t\t\t\t).color,\n\t\t\t\t\t\t\t\tisShownByDefault: defaultColorControls?.text,\n\t\t\t\t\t\t\t\thasValue: () => hasColor( 'text' )( props ),\n\t\t\t\t\t\t\t\tonDeselect: () => resetTextColor( props ),\n\t\t\t\t\t\t\t\tresetAllFilter: resetAllTextFilter,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t  ]\n\t\t\t\t\t: [] ),\n\t\t\t\t...( hasBackgroundColor || hasGradientColor\n\t\t\t\t\t? [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlabel: __( 'Background' ),\n\t\t\t\t\t\t\t\tonColorChange: hasBackgroundColor\n\t\t\t\t\t\t\t\t\t? onChangeColor( 'background' )\n\t\t\t\t\t\t\t\t\t: undefined,\n\t\t\t\t\t\t\t\tcolorValue: getColorObjectByAttributeValues(\n\t\t\t\t\t\t\t\t\tallSolids,\n\t\t\t\t\t\t\t\t\tbackgroundColor,\n\t\t\t\t\t\t\t\t\tstyle?.color?.background\n\t\t\t\t\t\t\t\t).color,\n\t\t\t\t\t\t\t\tgradientValue,\n\t\t\t\t\t\t\t\tonGradientChange: hasGradientColor\n\t\t\t\t\t\t\t\t\t? onChangeGradient\n\t\t\t\t\t\t\t\t\t: undefined,\n\t\t\t\t\t\t\t\tisShownByDefault:\n\t\t\t\t\t\t\t\t\tdefaultColorControls?.background,\n\t\t\t\t\t\t\t\thasValue: () =>\n\t\t\t\t\t\t\t\t\thasColor( 'background' )( props ),\n\t\t\t\t\t\t\t\tonDeselect: () =>\n\t\t\t\t\t\t\t\t\tresetBackgroundAndGradient( props ),\n\t\t\t\t\t\t\t\tresetAllFilter: clearBackgroundAndGradient,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t  ]\n\t\t\t\t\t: [] ),\n\t\t\t\t...( hasLinkColor\n\t\t\t\t\t? [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlabel: __( 'Link' ),\n\t\t\t\t\t\t\t\tonColorChange: onChangeLinkColor,\n\t\t\t\t\t\t\t\tcolorValue: getLinkColorFromAttributeValue(\n\t\t\t\t\t\t\t\t\tallSolids,\n\t\t\t\t\t\t\t\t\tstyle?.elements?.link?.color?.text\n\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\tclearable: !! style?.elements?.link?.color\n\t\t\t\t\t\t\t\t\t?.text,\n\t\t\t\t\t\t\t\tisShownByDefault: defaultColorControls?.link,\n\t\t\t\t\t\t\t\thasValue: () => hasColor( 'link' )( props ),\n\t\t\t\t\t\t\t\tonDeselect: () => resetLinkColor( props ),\n\t\t\t\t\t\t\t\tresetAllFilter: resetAllLinkFilter,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t  ]\n\t\t\t\t\t: [] ),\n\t\t\t] }\n\t\t/>\n\t);\n}\n\n/**\n * This adds inline styles for color palette colors.\n * Ideally, this is not needed and themes should load their palettes on the editor.\n *\n * @param {Function} BlockListBlock Original component.\n *\n * @return {Function} Wrapped component.\n */\nexport const withColorPaletteStyles = createHigherOrderComponent(\n\t( BlockListBlock ) => ( props ) => {\n\t\tconst { name, attributes } = props;\n\t\tconst { backgroundColor, textColor } = attributes;\n\t\tconst userPalette = useSetting( 'color.palette.custom' ) || [];\n\t\tconst themePalette = useSetting( 'color.palette.theme' ) || [];\n\t\tconst defaultPalette = useSetting( 'color.palette.default' ) || [];\n\t\tconst colors = useMemo(\n\t\t\t() => [\n\t\t\t\t...( userPalette || [] ),\n\t\t\t\t...( themePalette || [] ),\n\t\t\t\t...( defaultPalette || [] ),\n\t\t\t],\n\t\t\t[ userPalette, themePalette, defaultPalette ]\n\t\t);\n\t\tif (\n\t\t\t! hasColorSupport( name ) ||\n\t\t\tshouldSkipSerialization( name, COLOR_SUPPORT_KEY )\n\t\t) {\n\t\t\treturn <BlockListBlock { ...props } />;\n\t\t}\n\t\tconst extraStyles = {};\n\n\t\tif (\n\t\t\ttextColor &&\n\t\t\t! shouldSkipSerialization( name, COLOR_SUPPORT_KEY, 'text' )\n\t\t) {\n\t\t\textraStyles.color = getColorObjectByAttributeValues(\n\t\t\t\tcolors,\n\t\t\t\ttextColor\n\t\t\t)?.color;\n\t\t}\n\t\tif (\n\t\t\tbackgroundColor &&\n\t\t\t! shouldSkipSerialization( name, COLOR_SUPPORT_KEY, 'background' )\n\t\t) {\n\t\t\textraStyles.backgroundColor = getColorObjectByAttributeValues(\n\t\t\t\tcolors,\n\t\t\t\tbackgroundColor\n\t\t\t)?.color;\n\t\t}\n\n\t\tlet wrapperProps = props.wrapperProps;\n\t\twrapperProps = {\n\t\t\t...props.wrapperProps,\n\t\t\tstyle: {\n\t\t\t\t...extraStyles,\n\t\t\t\t...props.wrapperProps?.style,\n\t\t\t},\n\t\t};\n\n\t\treturn <BlockListBlock { ...props } wrapperProps={ wrapperProps } />;\n\t}\n);\n\nconst MIGRATION_PATHS = {\n\tlinkColor: [ [ 'style', 'elements', 'link', 'color', 'text' ] ],\n\ttextColor: [ [ 'textColor' ], [ 'style', 'color', 'text' ] ],\n\tbackgroundColor: [\n\t\t[ 'backgroundColor' ],\n\t\t[ 'style', 'color', 'background' ],\n\t],\n\tgradient: [ [ 'gradient' ], [ 'style', 'color', 'gradient' ] ],\n};\n\nexport function addTransforms( result, source, index, results ) {\n\tconst destinationBlockType = result.name;\n\tconst activeSupports = {\n\t\tlinkColor: hasLinkColorSupport( destinationBlockType ),\n\t\ttextColor: hasTextColorSupport( destinationBlockType ),\n\t\tbackgroundColor: hasBackgroundColorSupport( destinationBlockType ),\n\t\tgradient: hasGradientSupport( destinationBlockType ),\n\t};\n\treturn transformStyles(\n\t\tactiveSupports,\n\t\tMIGRATION_PATHS,\n\t\tresult,\n\t\tsource,\n\t\tindex,\n\t\tresults\n\t);\n}\n\naddFilter(\n\t'blocks.registerBlockType',\n\t'core/color/addAttribute',\n\taddAttributes\n);\n\naddFilter(\n\t'blocks.getSaveContent.extraProps',\n\t'core/color/addSaveProps',\n\taddSaveProps\n);\n\naddFilter(\n\t'blocks.registerBlockType',\n\t'core/color/addEditProps',\n\taddEditProps\n);\n\naddFilter(\n\t'editor.BlockListBlock',\n\t'core/color/with-color-palette-styles',\n\twithColorPaletteStyles\n);\n\naddFilter(\n\t'blocks.switchToBlockType.transformedBlock',\n\t'core/color/addTransforms',\n\taddTransforms\n);\n"]}